# Система модерации объявлений

Веб-приложение для внутренних модераторов площадки объявлений.  
Позволяет просматривать и фильтровать объявления, принимать решения по модерации и отслеживать персональную статистику.

---

## Описание проекта

Приложение решает задачу из тестового задания Авито: упрощённая внутренняя система модерации объявлений.

Основные возможности:

- **Список объявлений** с фильтрами, поиском, сортировкой и пагинацией.
- **Детальная карточка объявления** с галереей, характеристиками, данными продавца и панелью действий модератора.
- **Страница статистики** с ключевыми метриками и графиками по периодам.
- Часть функционала «со звёздочкой»: горячие клавиши, экспорт статистики в CSV, анимации появления карточек, прогресс-бар загрузки и фильтр по периоду на странице статистики модератора.

Приложение написано на React + TypeScript и использует готовый REST API из папки `server` оригинального тестового задания.

---

## Запуск проекта

### Требования

- Node.js **v20+**
- npm **v10+**
- Запущенный REST API на `http://localhost:3001`  
  (в тестовом задании используется готовый сервер из папки `server` — его нужно запустить отдельно по инструкции авторов задания, чтобы эндпоинты `/api/v1/...` были доступны).

### Установка

```bash

npm install

```

### Запуск в режиме разработки

```bash

npm run dev

```

После запуска Vite выведет адрес в консоль (по умолчанию `http://localhost:5173`).
Откройте его в браузере. Клиент будет обращаться к API на `http://localhost:3001/api/v1/...` (см. `src/api/http.ts`).

---

## Стек технологий

### Базовый стек

* **React 18** — функциональные компоненты и хуки.
* **TypeScript** — строгая типизация данных (объявления, статистика, ответы API).
* **Vite** — быстрая сборка и dev-сервер с HMR.
* **React Router DOM** — SPA-маршрутизация между `/list`, `/item/:id` и `/stats`.

### Необязательные библиотеки и обоснование

* **Axios**
  Используется вместо `fetch` для удобства настройки базового URL, перехватчиков и типизации ответов.
  Это позволяет централизованно конфигурировать HTTP-клиент в `src/api/http.ts` и переиспользовать его во всех API-модулях.

* **Recharts**
  Библиотека для графиков (линейный/столбчатый/круговой графики на странице статистики).
  Выбрана за:

  * простую декларативную интеграцию с React;
  * хороший набор готовых компонентов (LineChart, BarChart, PieChart, Tooltip и т.п.);
  * отсутствие необходимости писать «с нуля» графики.

* **Swiper**
  Используется для галереи изображений объявления на детальной странице.
  Дает «из коробки»:

  * свайпы/перелистывание;
  * навигационные стрелки и точки-индикаторы;
  * адаптивное поведение без собственной сложной реализации.

* **React Icons**
  Единый источник иконок (статусы, предупреждения и т.п.).
  Позволяет быстро подбирать иконки и использовать их как обычные React-компоненты.

* **Чистый CSS (по компонентам)**
  Стили разбиты по файлам рядом с компонентами (`AdCard.css`, `StatsPage.css` и т.д.).
  Используются flex-layout, медиазапросы и keyframe-анимации.

---

## Архитектура

Проект разделён по функциональным областям.

### Общая структура

```text
src/
  api/           # HTTP-клиент и функции для работы с API
  components/    # UI-компоненты (разделены по подсистемам)
    ads-list/
    ad-detail/
    stats/
  hooks/         # кастомные React-хуки
  pages/         # страницы-роуты
  types/         # общие типы данных (объявления, статистика и т.д.)
  utils/         # служебные утилиты (генерация CSV)
  App.tsx        # описание маршрутов и базового layout
  main.tsx       # точка входа, монтирование React-приложения
```

### Pages

* `src/pages/ListPage.tsx`
  Список объявлений, фильтры, сортировка, пагинация, анимация появления карточек.

* `src/pages/AdDetailPage.tsx`
  Детальная страница объявления с галереей, характеристиками, продавцом, панелью модерации и историей модерации. Поддерживает горячие клавиши для действий и навигации по объявлениям.

* `src/pages/StatsPage.tsx`
  Статистика модератора: карточки метрик, графики Recharts, переключатель периода, экспорт в CSV.

### Components

* `src/components/ads-list/`

  * `AdCard.tsx` — карточка объявления в списке: фото, заголовок, цена, бейдж статуса, бейдж «Срочно», кнопка «Открыть».
  * `AdsFilters.tsx` — панель фильтров: статус (множественный выбор), категория, диапазон цен, поиск по названию, сортировка.

* `src/components/ad-detail/`

  * `AdGallery.tsx` — Swiper-галерея изображений товара.
  * `ModerationPanel.tsx` — панель действий модератора (одобрить/отклонить/доработка + модальные окна с причинами).
  * `ModerationHistory.tsx` — карточки истории модерации с цветной полосой статуса и иконками.

* `src/components/stats/`

  * `StatsSummary.tsx` — набор карточек с основными метриками.
  * `ActivityChart.tsx` — линейный график активности по дням.
  * `DecisionsPieChart.tsx` — круговая диаграмма распределения решений.
  * `CategoriesBarChart.tsx` — горизонтальные столбики по категориям.
  * `StatsControls.tsx` — заголовок страницы статистики, переключатель периода и кнопка экспорта CSV.

### Hooks

* `useAdsList.ts`
  Инкапсулирует всю логику списка объявлений:

  * загрузка данных и категорий;
  * фильтры, сортировка и пагинация;
  * состояния загрузки/ошибки.

* `useAdDetails.ts`
  Загружает детальную информацию по объявлению, обновляет локальное состояние после действий модерации.

* `useStats.ts`
  Загружает сводку, данные для графиков и категории для выбранного периода (`today | week | month`), обрабатывает состояния загрузки/ошибок.

* `useHotkeys.ts`
  Универсальный хук для регистрации глобальных горячих клавиш:

  * принимает объект `{ [key: string]: (event) => void }`;
  * игнорирует ввод в полях (`input`, `textarea`, `select`);
  * автоматически подписывается/отписывается от `keydown` при монтировании/размонтировании.

### API

* `src/api/http.ts` — конфигурация Axios (базовый URL `/api/v1`, таймаут).

* `src/api/ads.ts` — функции для работы с объявлениями:

  * `getAdsList`, `getAdById`;
  * `approveAd`, `rejectAd`, `requestChanges`.

* `src/api/stats.ts` — функции для статистики:

  * `getStatsSummary`, `getActivityChart`, `getDecisionsChart`, `getCategoriesChart`.

### Типы и утилиты

* `src/types/ad.ts` — типы объявления, статусов, истории модерации и т.п.
* `src/types/stats.ts` — тип периода и структуры для всех статистических ответов.
* `src/utils/buildStatsCsv.ts` — формирование CSV-отчёта по текущему состоянию страницы статистики.

---

## Функциональность и соответствие ТЗ

### 1. Список объявлений (`/list`)

* Карточка содержит:

  * изображение (либо реальное, либо placeholder);
  * заголовок;
  * цену;
  * категорию;
  * дату создания;
  * статус (бейдж с цветом);
  * признак «Срочно».
* Фильтры:

  * по статусу (множественный выбор);
  * по категории;
  * по диапазону цен;
  * текстовый поиск по названию;
  * кнопка «Сбросить фильтры».
* Сортировка:

  * по дате (новые/старые);
  * по цене (возрастание/убывание);
  * по приоритету.
* Пагинация:

  * по 10 объявлений на страницу;
  * переключение страниц;
  * отображение общего количества объявлений.

### 2. Детальная страница объявления (`/item/:id`)

* Информация об объявлении:

  * Swiper-галерея из нескольких изображений;
  * полное описание;
  * таблица характеристик (ключ-значение);
  * блок продавца (имя, рейтинг, число объявлений, дата регистрации).
* История модерации:

  * список всех действий с цветовой индикацией и иконками;
  * кто проверял, когда, какое решение принял;
  * причина и комментарий (если есть).
* Панель модерации:

  * кнопки «Одобрить», «Отклонить», «Доработка»;
  * модальные окна с выбором причины;
  * для причины «Другое» комментарий обязателен;
  * защита от повторных запросов во время отправки;
  * обновление статуса и истории на странице без перезагрузки.
* Навигация:

  * «Назад к списку»;
  * «Пред» / «След» переходят к соседним объявлениям по ID.

### 3. Страница статистики (`/stats`)

* Карточки метрик:

  * всего проверено;
  * за сегодня, неделю, месяц;
  * процент одобренных / отклонённых / на доработку;
  * среднее время проверки.
* Графики (Recharts):

  * активность по дням (столбчатый/линейный график);
  * распределение решений (круговая диаграмма);
  * распределение по категориям (горизонтальные столбики).
* Фильтр по периоду:

  * Сегодня / 7 дней / 30 дней;
  * все показатели и графики пересчитываются на клиенте.

### Реализованные «звёздочки»

* **Горячие клавиши**
  На детальной странице:

  * `A` — одобрить;
  * `D` — отклонить;
  * `←` — предыдущее объявление;
  * `→` — следующее объявление.
    На странице списка:
  * `/` — сфокусироваться в поле поиска.

* **Экспорт данных в CSV**
  На `/stats` есть кнопка «Экспорт CSV».
  Формируется CSV-файл с основными метриками и данными графиков за выбранный период (реализация в `buildStatsCsv.ts`).

* **Анимации**

  * Появление карточек объявлений — CSS-анимация «волной» при подгрузке списка.
  * Прогресс-бар загрузки — на `/list`, `/item/{id}` и `/stats` вместо простого текста «Загрузка…».
 
* **Фильтр по периоду на странице статистики модератора**

  * фильтр по периодам: Сегодня, 7 дней, 30 дней

---

## Ограничения и возможные улучшения

Чтобы не выходить за рамки тестового задания и уложиться по времени, в проекте есть осознанные компромиссы:

* **Нет bulk-операций** (массовое одобрение/отклонение) и соответствующего UI.
* **Нет тёмной темы** и сохранения темы в `localStorage`.
* **Фильтры не синхронизируются с URL** и не сохраняются наборами.
  При перезагрузке страницы состояние фильтров сбрасывается.
* **Навигация «Пред/След»** идёт по соседним ID объявлений и не учитывает активные фильтры/сортировку.
* **Нет real-time обновлений** (WebSocket/SSE): список обновляется только по запросу.
* **Нет отмены HTTP-запросов** при смене страницы (можно доработать через `AbortController`).
* **Нет юнит-тестов и Docker-конфигурации** — для тестового проекта достаточно простой команды `npm run dev`;

Текущее решение опирается на `useState`/`useEffect` и кастомные хуки. Для роста проекта можно выделить:

* глобальное состояние (Redux Toolkit/Zustand/Context);
* React Query для кэширования и рефетчинга данных;

